use xk;
/*多表连接查询：内连接 和 外连接
内连接：只保留满足连接条件的数据行的链接

交叉连接： 笛卡尔积 考勤场景
交叉连接把一张学生表的所有数据行直接连接，产生所有排列组合
大多数的嵌套查询，可以使用多表连接查询替代的
输出列都来自于1张表，可以使用嵌套查询
输出列来自2张或者更多表，只能多表连接
输出，筛选条件，都来自一张表，拿一个子查询去包裹聚合函数*/
/*1 查询学生表和班级表的交叉连接的结果*/
select *
from class cross join student;

/*2 查询学生基本信息以及学生所在的班级信息*/
select *
from class join student
on class.classno = student.classno;

select *
from class,student
where class.classno = student.classno;

/*3 查询学生基本信息，班级名称*/
select student.*,classname
from class join student
on class.classno = student.classno;

/*4 查询学生的选课信息
要求显示学号 姓名 课号 课名 志愿号
要求按照学号升序排序，学号相同时，按照志愿号升序*/
select stucou.stuno,stuname,
       stucou.couno,couname,willorder
from stucou,student,course
where stucou.couno = course.couno
      and 
      stucou.stuno = student.stuno
order by stucou.stuno,willorder;

select stucou.stuno,stuname
       stucou.couno,couname,willorder
from stucou join course
on stucou.couno = course.couno
join student
on stucou.stuno = student.stuno
order by stucou.stuno,willorder;

/*5 查询学生报名了“计算结应用工程”系开设的选修课情况
显示：学生姓名，课名，系名*/
select stuname,couname,departname
from stucou,student,course,department
where stucou.stuno = student.stuno
      and
      stucou.couno = course.couno
      and
      course.departno = department.departno
      and
      departname = '计算机应用工程系';
      
select stuname,couname,departname
from department join course
on department.departno = course.departno
join stucou
on course.couno = stucou.couno
join student
on stucou.stuno = student.stuno
where departname = '计算机应用工程系';

/*6 查看00电子商务班的同学选修计算机应用工程系开发的选修课的情况
显示班名 姓名 课名 课所在的系的名称*/
select classname,stuname,couname,departname
from department,student,stucou,course,class
where department.departno = course.departno
      and
      stucou.couno = course.couno
      and
      stucou.stuno = student.stuno
      and
      student.classno = class.classno
      and
      departname = '计算机应用工程系'
      and
      classname = '00电子商务'
      
/*7 查询计算机应用工程系的所有同学们选修课程的情况
显示系名（人所在的系，不是课所在的系），姓名，课名*/
select departname,stuname,couname
from department,class,student,stucou,course
where department.departno = class.departno
      and
      class.classno = student.classno
      and
      student.stuno = stucou.stuno
      and
      course.couno = stucou.couno
      and
      departname = '计算机应用工程系'
      
/*8 计算机系的人，选了计算机系的课
显示 人所在的系名 姓名 课名 课所在的系的系名*/
select d2.departname as 人所在的系名,stuname,couname,d1.departname as 课所在的系
from department d1,department d2
     class,student,stucou,course
where d1.departno = course.departno
      and
      stucou.couno = course.couno
      and
      stucou.stuno = student.stuno
      and
      d2.departno = class.departno
      and
      class.classno = student.classno
      and
      d1.departname = '计算机应用工程系'
      and
      d2.departname = '计算机应用工程系';   